services:
  mcp-broker:
    build:
      context: ..
      dockerfile: mcp-broker/Dockerfile
    container_name: mcp-broker
    ports:
      - "127.0.0.1:3098:3098"
      - "127.0.0.1:3099:3099"
    environment:
      - MCP_HTTP_PORT=3098
      - BROKER_WS_PORT=3099
      - OLLAMA_API_URL=http://ollama-shared:11434
      - OLLAMA_MODEL=qwen2.5:1.5b
    restart: always
    extra_hosts:
      - "host.docker.internal:host-gateway"
    networks:
      - default
      - ollama-net

networks:
  ollama-net:
    external: true
    name: ollama-shared_default
